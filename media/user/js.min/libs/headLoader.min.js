/**
 * headLoader用于加载、预加载及缓存网站资源，实现网站快速响应，优化服务器请求的目的。使用纯前端技术，基本上用"0成本"就能使普通的网站得到明显的加速效果。
 * @global : headLoader
 * @author: 宇哥 baiyukey@qq.com
 * @param {String} [this.dataDir] -资源路径
 * @param {Array} [this.dataCss] -CSS模块列表
 * @param {Array} [this.dataJs] -JS资源路径
 * @param {Number} [this.dataLifecycle=2] -缓存生成周期，单位小时，默认2
 * @param {Boolean} [this.dataActive=false] -是否自动切换线上与线下代码路径，默认否
 * @param {Function} [this.callback=null] -所有资源加载完成后的回调函数 (仅命令行模式可用)
 * @param {Boolean} [this.showLog=false] -是否显示加载统计(仅命令行模式可用)
 * @param {Number} [this.preload=0] -预加载开关(仅命令行模式可用) 1:预加载打开(不应用于当前页面)，0:预加载关闭（加载后立即应用于当前页面）。 默认0 。
 * @link : https://github.com/baiyukey/headLoader
 * @version : 1.1.0
 * @copyright : http://www.uielf.com
 */
var headLoader=void 0;!function(t){var e=/^((192\.168|172\.([1][6-9]|[2]\d|3[01]))(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){2}|10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){3})|(localhost)$/.test(t.location.hostname)?"":".min";headLoader=function(a){var n=a||{};this.dataDir=n.dataDir||"",this.dataCss=n.dataCss||[],this.dataJs=n.dataJs||[],this.dataLifecycle=n.dataLifecycle||l,this.dataActive=n.dataActive||c,this.callback=n.callback||null,this.multiLoad=n.multiLoad||".min"===e,this.showLog=n.showLog||!1,this.preload=void 0!==n.preload?n.preload:0;var i=this,o=function(t){return 0===t.indexOf("http://")||0===t.indexOf("https://")},r=function(t){var a=new Date,n=t||2;return n=Math.min(24,n),""===e?""+a.getTime():""+(a.getMonth()+1)+a.getDate()+Math.ceil((a.getHours()+1)/n)},p=function(t){for(var e=[],a="",n=0;n<t.length;n++)0!==(a=t[n].replace(/^(\s*)|(\s*)$/g,"")).length&&e.indexOf(a)<0&&e.push(a);return e},f=function(t,e){e.length>0&&e.forEach(function(e){t.setAttribute(e.split("=")[0],e.split("=")[1])})};void 0===t.headLoaderCache&&(t.headLoaderCache={});var g=function(e,a){var n,i;n=H.encode(e),i=a,t.headLoaderCache[n]=i,t.localStorage.setItem(n,i)},J=function(e){return a=H.encode(e),t.headLoaderCache[a]||(t.headLoaderCache[a]=t.localStorage.getItem(a)),t.headLoaderCache[a];var a},U=function(t,a){return i.dataActive?(""+i.dataDir+a+e+"/"+t.split("|")[0]).replace("."+a,"")+e+"."+a:""+i.dataDir+t.split("|")[0]+"."+a},v=function(t,a){return((i.dataDir+a+e+"/"+t.split("|")[0]).replace("."+a,"")+e).replace(/\./g,"_")},T=function(t,e){if(o(t))return w(t),"function"==typeof e&&e(),!1;var a=U(t,"js")+"?v="+s,n=v(t,"js"),i=void 0,r=J(n),c=J(n+"_version");null===r||c!==s?(window.XMLHttpRequest?i=new XMLHttpRequest:window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLHTTP")),void 0!==i&&(i.open("GET",a),i.send(null),i.onreadystatechange=function(){4===Number(i.readyState)&&200===Number(i.status)&&(r=i.responseText,g(n,r=null===r?"":r),g(n+"_version",s),u++,"function"==typeof e&&e())})):"function"==typeof e&&e()},y=function(t,e){if(o(t))return A(t),"function"==typeof e&&e(),!1;var a=U(t,"css")+"?v="+s,n=v(t,"css"),r=void 0,c=J(n),l=J(n+"_version");null===c||l!==s?(window.XMLHttpRequest?r=new XMLHttpRequest:window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLHTTP")),void 0!==r&&(r.open("GET",a),r.send(null),r.onreadystatechange=function(){4===Number(r.readyState)&&200===Number(r.status)&&(c=(c=(c=null===(c=r.responseText)?"":c).replace(/\[dataDir]/g,i.dataDir)).replace(/\[v]/g,d),g(n,c),g(n+"_version",s),u++,"function"==typeof e&&e())})):"function"==typeof e&&e()},L=function(t,a){if(""!==e)return Function(a)(),!1;var n=document.getElementsByTagName("HEAD").item(0),i=document.createElement("script");f(i,t.split("|").splice(1)),i.setAttribute("type","text/javascript"),i.setAttribute("data-name",t.split("|")[0].replace(".js","")+e),i.innerHTML=a,n.appendChild(i)},b=function(t,a){if(0===document.getElementsByTagName("HEAD").length)return!1;var n=document.getElementsByTagName("HEAD").item(0),o=void 0;if(i.multiLoad&&(o=document.getElementsByTagName("style").item(0)))return o.innerHTML+=a,!1;o=document.createElement("style"),f(o,t.split("|").splice(1)),o.setAttribute("type","text/css"),o.setAttribute("data-name",t.split("|")[0].replace(".css","")+e),o.innerHTML=a,n.appendChild(o)},w=function(t){if(0===document.getElementsByTagName("HEAD").length)return!1;var a=document.getElementsByTagName("HEAD").item(0),n=document.createElement("script");f(n,t.split("|").splice(1)),n.src=0===t.indexOf("http")?t.split("|")[0]:t.split("|")[0].replace(".js","")+e+".js?"+s,a.appendChild(n)},A=function(t){if(0===document.getElementsByTagName("HEAD").length)return!1;var a=document.getElementsByTagName("HEAD").item(0),n=document.createElement("link");f(n,t.split("|").splice(1)),n.type="text/css",n.rel="stylesheet",n.media="screen",n.href=0===t.indexOf("http")?t.split("|")[0]:t.split("|")[0].replace(".css","")+e+".css?"+s,a.appendChild(n)},E=function(t,a){var n=void 0,o={JS:L,CSS:b}[a.toUpperCase()],r=t.map(function(t){return n=(i.dataDir+a+e+"/"+t.replace(/(\.js)|(\.css)/g,"")+e).replace(/\./g,"_"),J(n)}).join("js"===a?";":" ");o(1===t.length?t[0]:a+"_"+s,r)},C=function(t,e,a){if(0===document.getElementsByTagName("HEAD").length)return!1;if(!t||0===t.length)return"function"==typeof a&&a.call(!1),!1;var n={JS:T,CSS:y}[e.toUpperCase()];(i.multiLoad?function(){if(!t||0===t.length)return"function"==typeof a&&a.call(!1),!1;var o=new Array(t.length).fill(0).map(function(e,a){return new Promise(function(e){n(t[a],function(){return e("success")})})});Promise.all(o).then(function(){0!==t.length&&0===i.preload&&E(t,e),"function"==typeof a&&a.call(!1)})}:function(){var o=0;!function r(){o>=t.length?"function"==typeof a&&a.call(!1):n(t[o],function(){0===i.preload&&E([t[o]],e),o++,r()})}()})()},H=new function(){for(var t="",e=48;e<=122;e++)e>=58&&e<=64||e>=91&&e<=96||(t+=String.fromCharCode(e));var a=(t=(t=t.replace(/[aeiouAEIOU01]/g,"")).slice(0,18)+"$-_+!*"+t.slice(18)).length,n=location.host.length,i=-1,o="",r="";this.encode=function(e){o=encodeURIComponent(e).replace(/\./g,"&dot"),r="",i=-1;for(var c=0;c<o.length;c++)i=t.indexOf(o.charAt(c)),r+=i<0?o.charAt(c):t.charAt((i+n)%a);return r}};this.run=function(){i.dataCss=p(i.dataCss.join(",").replace(/_css/g,m).split(",")),i.dataJs=p(i.dataJs.join(",").replace(/_js/g,m).split(",")),s=r(l),d=r(24);var e=function(){var e;i.showLog&&(e=(new Date).getTime()-h,t.headLoaderHistory=void 0!==t.headLoaderHistory?t.headLoaderHistory:[],void 0!==t.showLogTimeout&&clearTimeout(t.showLogTimeout),t.showLogTimeout=setTimeout(function(){u>0&&(t.headLoaderHistory=t.headLoaderHistory.concat(new Array(u-1).fill(0),e));var a=0,n=0;t.headLoaderHistory.length>0&&(a=t.headLoaderHistory.reduce(function(t,e){return t+e}),n=Math.ceil(a/t.headLoaderHistory.length)),console.log("当前页面使用headLoader"+(i.multiLoad?"并行":"串行")+"网络请求%c"+u+"个%cJS/CSS文件，程序用时%c"+e+"毫秒%c，累计网络请求%c"+t.headLoaderHistory.length+"个%cJS/CSS文件，单文件平均用时%c"+n+"毫秒","color:#1b8884","","color:#1b8884","","color:#1b8884","","color:#1b8884","")},3e3)),"function"==typeof i.callback&&i.callback.call(!1)};C(i.dataCss,"css",function(){C(i.dataJs,"js",e)})}};for(var a=document.getElementsByTagName("script"),n=void 0,i=[],o=[],r=void 0,c=!1,l=2,s="",d="",u=0,h=(new Date).getTime(),p=0;p<a.length;p++)if(a[p].hasAttribute("src")&&a[p].getAttribute("src").indexOf(atob("aGVhZExvYWRlci4="))>=0){n=a.item(p);break}if(!n)return console.log&&console.log("%c"+decodeURIComponent(atob("JUU5JTk0JTk5JUU4JUFGJUFGJUU2JThGJTkwJUU3JUE0JUJBJTNBJUU3JUE4JThCJUU1JUJBJThGJUU2JTlDJUFBJUU2JTg4JTkwJUU1JThBJTlGJUU2JTg5JUE3JUU4JUExJThDJTJDJUU2JThGJTkyJUU0JUJCJUI2JUU1JTkwJThEJUU3JUE3JUIwJUU0JUI4JUJBaGVhZExvYWRlci5qcyVFNiU4OCU5NiVFOCU4MCU4NWhlYWRMb2FkZXIubWluLmpzJUU2JUIzJUE4JUU2JTg0JThGJUU1JUE0JUE3JUU1JUIwJThGJUU1JTg2JTk5LiVFNSVBNiU4MiVFNiU5QyU4OSVFNyU5NiU5MSVFOSU5NyVBRSVFOCVBRiVCNyVFOCVBRSVCRiVFOSU5NyVBRSUzQWh0dHBzJTNBJTJGJTJGZ2l0aHViLmNvbSUyRmJhaXl1a2V5JTJGaGVhZExvYWRlcg==")),"color:#F00"),!1;var f=console.log&&".min"!==e,g="static"===location.pathname.split("/")[1]?"/static":"/",m=location.pathname.replace(g,"").replace(".html","");""===location.pathname.replace(/.*\//,"").replace(".html","")&&(m+="index"),m=0===m.indexOf("/")?m.substr(1):m,n.hasAttribute("data-active")?c=["true",""].includes(n.getAttribute("data-active")):f&&console.log('%c友情提示:script标签未设置"data-active"属性,默认为false.',"color:#69F;"),n.hasAttribute("data-lifecycle")?l=Number(n.getAttribute("data-lifecycle")):f&&console.log('%c友情提示:script标签未设置"data-lifecycle"属性,默认为'+l+"小时.","color:#69F;"),n.hasAttribute("data-dir")?r=n.getAttribute("data-dir"):f&&console.log('%c友情提示:script标签未设置"data-dir"属性.',"color:#69F;"),n.hasAttribute("data-css")?o=n.getAttribute("data-css").split(","):f&&console.log('%c友情提示:script标签未设置"data-css"属性',"color:#69F;"),n.hasAttribute("data-js")?i=n.getAttribute("data-js").split(","):f&&console.log('%c友情提示:script标签未设置"data-js"属性',"color:#69F;"),a.length>0&&""!==e&&a.item(0).remove();var J=new headLoader;r&&(J.dataDir=r),J.dataCss=o,J.dataJs=i,J.dataLifecycle=l,J.run()}(window.location.origin===window.top.location.origin?window.top:window);
