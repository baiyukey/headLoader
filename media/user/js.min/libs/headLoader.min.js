/**
 * @link : https://github.com/baiyukey/headLoader
 * @version : 2.4.8
 * @copyright : http://www.uielf.com
 */
function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(r,o){try{var i=t[r](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})}}const headLoaderSource=function(){const e="null"===window.location.origin||window.location.origin===window.top.location.origin?window.top:window,t=document.getElementsByTagName("HEAD").item(0);if(!e.Promise)return e.onload=function(){document.body.innerHTML='<div style="text-align:center"><ul style="display:inline-block;margin-top:20px;text-align:left;list-style:none;line-height:32px;"><li style="list-style:none;"><h3>抱歉，您的浏览器不支持运行当前页面！</h3>如下两种方法供您参考：</li><li>✱ 请将您的浏览器切换到 "极速内核" (如果有)。</li><li>✱ <a href="https://www.google.cn/chrome/">或者下载安装 "chrome" 浏览器后重试。</a></li></ul></div>'};const n=e.XMLHttpRequest,a=/^(((192\.168|172\.([1][6-9]|[2]\d|3[01]))(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){2}|10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){3})|(localhost)|(127.0.0.1))$/.test(e.location.hostname)?"":".min",r={0:"网络连接失败。",404:"该资源找不到了。",500:"无权访问。",503:"该请求已被阻止。"},o=function(e,t){if(""===a)return(new Date).getTime();let n=new Date("2000/1/1").getTime();return n+1e3*Math.ceil(((new Date).getTime()-1e3*(t||0)*60*60-n)/(36e5*e))*60*60*e+1e3*(t||0)*60*60},i=e=>e.replace(/^.*\.(\w*)[?#]*.*$/,"$1");let s=new function(){let e="";for(let t=48;t<=122;t++)t>=58&&t<=64||t>=91&&t<=96||(e+=String.fromCharCode(t));let t=(e=(e=e.replace(/[aeiouAEIOU01]/g,"")).slice(0,18)+"$-_+!*"+e.slice(18)).length,n=location.host.length,a=-1,r="",o="";this.encode=function(i){r=encodeURIComponent(i).replace(/\./g,"&dot"),o="",a=-1;for(let i=0;i<r.length;i++)a=e.indexOf(r.charAt(i)),o+=a<0?r.charAt(i):e.charAt((a+n)%t);return o}},l=function(t){let n={database:"localDB",tables:{data:["key","value","version"]},version:o(".min"===a?24:0)};Object.assign(n,t);e.localDBResult=e.localDBResult||null,e.localDBStatus=e.localDBStatus||0;const r=function(){return void 0!==e.waitCloseLocalDB&&clearTimeout(e.waitCloseLocalDB),new Promise((t,a)=>{if(null!==e.localDBResult&&1===e.localDBStatus)return void t("success");let r=e.indexedDB.open(n.database);r.onerror=function(e){a(e)},r.onsuccess=function(n){e.localDBResult=r.result,e.localDBStatus=1,t(n)},r.onupgradeneeded=function(a){e.localDBResult=a.target.result,e.localDBStatus=1;let r=Object.keys(n.tables);for(const t of r)if(!e.localDBResult.objectStoreNames.contains(t)){let a=e.localDBResult.createObjectStore(t,{keyPath:"key"});n.tables[t].forEach(e=>a.createIndex(e,["key"],{unique:!0}))}a.target.transaction.oncomplete=(()=>t(e.localDBResult))}})},i=function(t){return void 0!==e.waitCloseLocalDB&&clearTimeout(e.waitCloseLocalDB),new Promise((n,a)=>{e.waitCloseLocalDB=setTimeout(function(){e.localDBResult&&e.localDBResult.close(),e.localDBStatus=0,n("success")},t||3e3)})},l=(c=_asyncToGenerator(function*(){if(!e.localDBResult)return console.warn(`目前还没有库${n.database}`);yield i(0),e.indexedDB.deleteDatabase(n.database),T&&console.log(`${n.database}已删除`)}),function(){return c.apply(this,arguments)});var c;const d=function(){let t={tableName:"data",key:"",value:null,etag:""};return"object"==typeof arguments[0]?Object.assign(t,arguments[0]):(t.key=arguments[0]||t.key,t.value=arguments[1]||t.value,t.tableName=arguments[2]||t.tableName),new Promise((o=_asyncToGenerator(function*(o,i){yield r();let l={key:".min"===a?s.encode(t.key):t.key,value:t.value,etag:t.etag,version:n.version},c="add";yield f(t.key).then(function(e){c=e?"put":"add"}).catch(function(e){c="add"});let u=e.localDBResult.transaction(t.tableName,"readwrite").objectStore(t.tableName)[c](l);u.onsuccess=function(){o(l)},u.onerror=function(e){i(e.target.error)}}),function(e,t){return o.apply(this,arguments)}));var o},f=function(t,n){return new Promise((o=_asyncToGenerator(function*(o,i){let l={},c=(u=_asyncToGenerator(function*(){yield r();let c=n||"data",u=e.localDBResult.transaction(c,"readonly").objectStore(c),d=".min"===a?s.encode(t):t,f=u.index("key").get([d]);f.onsuccess=function(e){(l=e.target.result)&&Object.assign(l,{key:t}),o(l)},f.onerror=function(e){return i(e)}}),function(){return u.apply(this,arguments)});var u;if(l=C.temp[t])return o(l),!0;yield c()}),function(e,t){return o.apply(this,arguments)}));var o},h=(y=_asyncToGenerator(function*(e){let t=yield f(e);return!!t&&t.value}),function(e){return y.apply(this,arguments)});var y;const p=(m=_asyncToGenerator(function*(e,t){let n=u(e,"css");return yield f(C.getUrl(n,"css"),t||"data")}),function(e,t){return m.apply(this,arguments)});var m;const g=(b=_asyncToGenerator(function*(e,t){let n=u(e,"html");return yield f(C.getUrl(n,"html"),t||"data")}),function(e,t){return b.apply(this,arguments)});var b;const v=(w=_asyncToGenerator(function*(e,t){let n=u(e,"js");return yield f(C.getUrl(n,"js"),t||"data")}),function(e,t){return w.apply(this,arguments)});var w;const D=(j=_asyncToGenerator(function*(e){let t=yield f(e);return!!t&&((e,t)=>{let n=[],a=new Uint8Array(e);for(let e=0;e<a.byteLength;e++)n.push(String.fromCharCode(a[e]));return`data:image/${t};base64,${window.btoa(n.join(""))}`})(t.value,(e=>{let t=e.replace(/^.*\.(\w*)[?#]*.*$/,"$1");return e!==t&&t})(e)||"jpeg")}),function(e){return j.apply(this,arguments)});var j;(function(){return!!(e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB)||(console&&console.log("您的浏览器不支持indexedDB，请使用现代浏览器，例如chrome,firefox等."),!1)})&&(this.open=r,this.close=i,this.delete=l,this.setItem=d,this.getItem=f,this.setValue=d,this.getValue=h,this.getCss=p,this.getHtml=g,this.getJs=v,this.getBase64=D,this.temp={});let C=this};e.localDB=l;let c,u=(e,t)=>e&&t?e.replace(/^(\s*)|(\s*)$/g,"").replace(`(.${t})`,""):e&&!t?e.replace(/^(\s*)|(\s*)$/g,"").replace(`(.${i(e)}`,""):console.error("模块格式错误"),d=function(s){let c=void 0!==s?s:{};this.dataMin=a,this.dataDir=c.dataDir||"",this.dataCss=c.dataCss||[],this.dataJs=c.dataJs||[],this.dataFont=c.dataFont||[],this.dataFile=c.dataFile||[],this.lifeCycle="object"==typeof c.lifeCycle?c.lifeCycle[0]:c.lifeCycle||24,this.cycleDelay="object"==typeof c.lifeCycle?c.lifeCycle[1]:c.cycleDelay||0,this.dataActive=c.dataActive||g,this.callback=c.callback||null,this.multiLoad=c.multiLoad||".min"===a,this.showLog=c.showLog||!1,this.preload=void 0!==c.preload?c.preload:0;let d=function(e,t){t.length>0&&t.forEach(function(t){e.setAttribute(t.split("=")[0],t.split("=")[1])})};void 0===e.headLoaderCache&&(e.headLoaderCache={});let f=function(e,t,n){return G.dataActive&&["js","css"].includes(t)?`${G.dataDir}${t}${a}/${e.split("|")[0]}`.replace("."+(n||t),"")+a+"."+(n||t):e},h=function(e,t){return["js","css"].includes(t)?(G.dataDir+t+a+"/"+e.split("|")[0]).replace("."+t,"")+a+"."+t:e},y=function(e,t){return new Promise((r,o)=>{if(!e)return r(2);Number(e.version)<Number(G.requestVersion)?""===e.etag?r(2):(a=t,new Promise((e,t)=>{let r=new n;r.open("HEAD",a,!0),r.send(),r.onreadystatechange=function(){4===Number(r.readyState)&&200===Number(r.status)&&e(r.getResponseHeader("etag")||r.getResponseHeader("last-modified")||"")},r.onerror=(e=>t(e))})).then(t=>{e.etag===t?r(1):r(2)}).catch(e=>o(e)):r(0)});var a},p=(m=_asyncToGenerator(function*(e,t){return new Promise(function(a,o){if((e=>/^http[s]?:\/\//.test(e))(e))return"js"===t?L(e):"css"===t&&A(e),a("success");let s=f(e,t)+(e.indexOf("?")>=0?"&v=":"?v=")+G.requestVersion,l=h(e,t),c=(u=_asyncToGenerator(function*(e,t){let c={};if(Object.assign(c,{key:l,value:t?t.value:"",etag:t?t.etag:"",version:t?t.version:G.requestVersion,exception:!!t&&t.exception}),0===e)G.db.temp[l]=c,a("success");else if(1===e)G.db.temp[l]=c,a("success"),c.version=G.requestVersion,yield G.db.setItem(c);else if(2===e){let e=i(c.key),t=["js","ts","css","svg","text","xml","json","html","htm"].includes(e)?"text":"arraybuffer",u=function(e){c.version=0,c.value="",c.exception={code:e,detail:`Error-${e} ! ${r[e]||""}`},G.db.temp[l]=c,a(`${c.key} 返回 ${c.exception.detail}`)};if(window.fetch){let e=yield fetch(s).catch(function(e){return u("TypeError"===e.name?0:e.name)});if(e.ok){let n="arraybuffer"===t?yield e.arrayBuffer():yield e.text();Object.assign(c,{value:n,etag:e.headers.get("etag")||e.headers.get("last-modified")||"",version:G.requestVersion,exception:!1}),G.db.temp[l]=c,a("success"),yield G.db.setItem(c)}else u(e.status)}else{let e=new n;e.open("GET",s),e.responseType=t,e.send(),e.onreadystatechange=_asyncToGenerator(function*(){if(4!==Number(e.readyState))return!1;if(G.showLog&&w++,200===Number(e.status)){let n=e["arraybuffer"===t?"response":"responseText"];Object.assign(c,{value:n,etag:e.getResponseHeader("etag")||e.getResponseHeader("last-modified")||"",version:G.requestVersion,exception:!1}),G.db.temp[l]=c,a("success"),yield G.db.setItem(c)}else u(e.status),e.abort()}),e.onerror=function(t){e.abort(),o(t)}}}}),function(e,t){return u.apply(this,arguments)});var u;G.db.getItem(l).then(function(e){y(e,s).then(function(t){return c(t,e)}).catch(function(e){return console.error(e)})})})}),function(e,t){return m.apply(this,arguments)});var m;let b=function(e){if(""!==a)return Function(Object.values(e).join(";"))(),!0;let n=document.createElement("script"),r=1===Object.keys(e).length?Object.keys(e)[0]:"_js"+G.requestVersion;r=r.split("|")[0].replace(/(\.css)|(\.min)/g,""),n.setAttribute("type","text/javascript"),n.setAttribute("data-name",r),n.innerHTML=Object.values(e).join(";"),t.appendChild(n)},v=function(e){let n,r=1===Object.keys(e).length?Object.keys(e)[0]:"_css"+G.requestVersion;if(r=r.split("|")[0].replace(/(\.css)|(\.min)/g,""),""!==a&&null!==(n=t.querySelector(`[data-name=${r}]`)))return n.innerHTML+=Object.values(e).join(" "),!1;(n=document.createElement("style")).setAttribute("type","text/css"),n.setAttribute("data-name",r),n.innerHTML=Object.values(e).join(" "),t.appendChild(n)},T=(j=_asyncToGenerator(function*(e){Object.keys(e).forEach(function(t){document.fonts.add(new FontFace(t.replace(/^.*\/|\..*$/g,""),e[t]))})}),function(e){return j.apply(this,arguments)});var j;let L=function(e){if(0===document.getElementsByTagName("HEAD").length)return!1;let n=document.createElement("script");d(n,e.split("|").splice(1)),n.src=0===e.indexOf("http")?e.split("|")[0]:e.split("|")[0].replace(".js","")+a+".js?v="+G.requestVersion,t.appendChild(n)},A=function(e){if(0===document.getElementsByTagName("HEAD").length)return!1;let n=document.createElement("link");d(n,e.split("|").splice(1)),n.type="text/css",n.rel="stylesheet",n.media="screen",n.href=0===e.indexOf("http")?e.split("|")[0]:e.split("|")[0].replace(".css","")+a+".css?v="+G.requestVersion,t.appendChild(n)},x=(S=_asyncToGenerator(function*(e,t){return new Promise(function(n,a){let r,o={JS:b,CSS:v,FONT:T}[t.toUpperCase()],i={},s=[];e.forEach(function(e){i[e]="";s.push(new Promise(function(n,a){r=h(e,t);let o=G.db.temp[r]?G.db.temp[r]:"";i[e]=o.value,G.returnData.push({key:e,value:o.value||"",version:o.version,etag:o.etag,exception:o.exception||!1}),n("success")}))}),Promise.all(s).then(function(){return 1===G.preload?(n("success"),!1):o?(o(i),void n("success")):n("页面写入仅支持js、css、font")}).catch(function(e){return a(e)})})}),function(e,t){return S.apply(this,arguments)});var S;let B=function(e,t){return e&&0!==e.length?new Promise(G.multiLoad?function(e,t){return n=_asyncToGenerator(function*(n){let a=new Array(e.length).fill(0).map(function(n,a){return new Promise((r=_asyncToGenerator(function*(n){yield p(e[a],t),n("success")}),function(e){return r.apply(this,arguments)}));var r});var r;Promise.all(a).then((r=_asyncToGenerator(function*(a){yield x(e,t),n("success")}),function(e){return r.apply(this,arguments)}))}),function(e){return n.apply(this,arguments)};var n}(e,t):function(e,t){return n=_asyncToGenerator(function*(n){let a=0,r=(o=_asyncToGenerator(function*(){if(a>=e.length)return!0;yield p(e[a],t),yield x([e[a]],t),yield r(a++)}),function(){return o.apply(this,arguments)});var o;yield r(),n("success")}),function(e){return n.apply(this,arguments)};var n}(e,t)):new Promise(e=>e("success"))};var F,_,k,$;this.db=new l({version:this.requestVersion}),this.db.temp={},this.db.getUrl=f,this.returnData={},this.run=_asyncToGenerator(function*(){return"object"==typeof this.lifeCycle&&(G.lifeCycle=this.lifeCycle[0],G.cycleDelay=this.lifeCycle[1]),G.requestVersion=o(G.lifeCycle,G.cycleDelay),G.db=new l({version:G.requestVersion}),this.db.temp={},this.db.getUrl=f,this.returnData={},G.returnData=[],G.dataCss=G.dataCss.map(function(e){return u("_css"===e?C:e,"css")}),G.dataCss=Array.from(new Set(G.dataCss)),G.dataJs=G.dataJs.map(function(e){return u("_js"===e?C:e,"js")}),G.dataJs=Array.from(new Set(G.dataJs)),G.dataFont=G.dataFont.map(function(e){return u(e,"")}),G.dataFont=Array.from(new Set(G.dataFont)),G.dataFile=G.dataFile.map(function(e){return u(e,"")}),G.dataFile=Array.from(new Set(G.dataFile)),yield G.db.open(),yield B(G.dataCss,"css"),yield B(G.dataFont,"font"),yield B(G.dataJs,"js"),yield B(G.dataFile,""),G.showLog&&function(){let t=(new Date).getTime()-D;e.headLoaderHistory=void 0!==e.headLoaderHistory?e.headLoaderHistory:[],void 0!==e.showLogTimeout&&clearTimeout(e.showLogTimeout),e.showLogTimeout=setTimeout(()=>{w>0&&(e.headLoaderHistory=e.headLoaderHistory.concat(new Array(w-1).fill(0),t));let n=0,a=0;e.headLoaderHistory.length>0&&(n=e.headLoaderHistory.reduce((e,t)=>e+t),a=Math.ceil(n/e.headLoaderHistory.length)),console.log("当前页面使用headLoader"+(G.multiLoad?"并行":"串行")+"网络请求%c"+w+"个%cJS/CSS文件，程序用时%c"+t+"毫秒%c，累计网络请求%c"+e.headLoaderHistory.length+"个%cJS/CSS文件，单文件平均用时%c"+a+"毫秒","color:#1b8884","","color:#1b8884","","color:#1b8884","","color:#1b8884","")},3e3)}(),"function"==typeof G.callback&&G.callback.call(G,G.returnData),0!==G.returnData.length&&(1===G.returnData.length?G.returnData[0]:G.returnData)}),this.loadFile=(F=_asyncToGenerator(function*(e,t){return G.dataCss=[],G.dataJS=[],G.dataFont=[],G.dataFile=[e].flat(),G.preload=1,yield G.run()}),function(e,t){return F.apply(this,arguments)}),this.loadJs=(_=_asyncToGenerator(function*(e){return G.dataCss=[],G.dataJs=[e].flat(),G.dataFont=[],G.dataFile=[],G.preload=1,yield G.run()}),function(e){return _.apply(this,arguments)}),this.loadCss=(k=_asyncToGenerator(function*(e){return G.dataCss=[e].flat(),G.dataJS=[],G.dataFont=[],G.dataFile=[],G.preload=1,yield G.run()}),function(e){return k.apply(this,arguments)}),this.loadFont=($=_asyncToGenerator(function*(e){return G.dataCss=[],G.dataJS=[],G.dataFont=[e].flat(),G.dataFile=[],G.preload=1,yield G.run()}),function(e){return $.apply(this,arguments)}),this.nextLife=function(e,t){let n=e||G.lifeCycle,a=t||G.cycleDelay;return new Date(o(n,a)).toLocaleString()};let G=this};e.headLoader=d,e.hLoader=d;let f,h=[],y=[],p=[],m=[],g=!1,b=24,v=0,w=1,D=(new Date).getTime();c=document.currentScript;let T=console.log&&".min"!==a,j=!1,C=(window===window.top?location.pathname:window.frameElement.getAttribute("src")||window.frameElement.pathname||"/404.html").replace(/^(.*\/)(.*)(\.html)([?]*)(.*)$/,"$1$2$4$5");var L;"/"===C.substr(-1)&&(C+="index"),C=0===C.indexOf("/")?C.substr(1):C,c.hasAttribute("data-active")?g=["true",""].includes(c.getAttribute("data-active")):T&&console.log('%c友情提示:script标签未设置"data-active"属性,默认为false.',"color:#69F;"),c.hasAttribute("data-lifecycle")&&(b=Number(c.getAttribute("data-lifecycle"))),c.hasAttribute("data-cycledelay")?v=Number(c.getAttribute("data-cycledelay")):T&&console.log('%c友情提示:script标签未设置"data-lifeCycle"属性,默认为0(开发环境)或24小时(线上环境）.',"color:#69F;"),c.hasAttribute("data-dir")?f=c.getAttribute("data-dir"):T&&console.log('%c友情提示:script标签未设置"data-dir"属性.',"color:#69F;"),c.hasAttribute("data-css")?y=c.getAttribute("data-css").split(","):T&&console.log('%c友情提示:script标签未设置"data-css"属性',"color:#69F;"),c.hasAttribute("data-js")?h=c.getAttribute("data-js").split(","):T&&console.log('%c友情提示:script标签未设置"data-js"属性',"color:#69F;"),c.hasAttribute("data-font")&&(p=c.getAttribute("data-font").split(",")),c.hasAttribute("data-file")&&(m=c.getAttribute("data-file").split(",")),c.hasAttribute("data-showlog")&&(j=["true",""].includes(c.getAttribute("data-showlog"))),""!==a&&c.remove(),(L=_asyncToGenerator(function*(e){if(0===document.getElementsByTagName("HEAD").length)return!1;let t=new d;t.lifeCycle=b,t.cycleDelay=v,f&&(t.dataDir=f),y.length>0&&(t.dataCss=y),h.length>0&&(t.dataJs=h),p.length>0&&(t.dataFont=p),m.length>0&&(t.dataFile=m),t.showLog=j;let n=c.src.replace(/.+\.js\?v=(.*)/,"$1");if(n=new Date(n).getTime()){let e=yield t.db.getValue("srcSearch");(!e||"number"!=typeof e||e&&e<n)&&(yield t.db.delete(),yield t.db.setValue("srcSearch",n),localStorage.clear())}yield t.run()}),function(e){return L.apply(this,arguments)})()};headLoaderSource(),getHeaderLoader=(e=>`function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(r,o){try{var s=t[r](o),i=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(i).then(function(e){a("next",e)},function(e){a("throw",e)});e(i)}("next")})}} const headLoaderSource=${headLoaderSource};headLoaderSource()`);
